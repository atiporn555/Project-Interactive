<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>เรื่องเล่าฝน</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="Night4-choice-key-after-start1.css">
</head>
<body>

  <!-- Background overlay -->
  <div id="bg-container">
    <div class="bg-image show" style="background-image:url('images/hand.png');"></div>
  </div>

  <div class="scene-container">
    <div id="caption-text"></div>
  </div>

  <script>
    const captionEl = document.getElementById('caption-text');
    const bgContainer = document.getElementById('bg-container');

    // Timeline ของ background
    const bgTimeline = [
      {time: 5000, img:'images/car-forest.png'},
      {time: 10000, img:'images/big-help.png'},
      {time: 15000, img:'images/Time-catch-Fon.png'},
      {time: 23000, img:'images/time-run.png'},
      {time: 30000, img:'images/big-hug-fon.png'},
      {time: 35000, img:'images/police-station.png'}
    ];

    function changeBackgroundSmooth(imagePath) {
      const newDiv = document.createElement('div');
      newDiv.className = 'bg-image';
      newDiv.style.backgroundImage = `url('${imagePath}')`;
      bgContainer.appendChild(newDiv);
      setTimeout(() => newDiv.classList.add('show'), 50);
      const oldDivs = bgContainer.querySelectorAll('.bg-image');
      if (oldDivs.length > 1) setTimeout(() => oldDivs[0].remove(), 800);
    }

    bgTimeline.forEach(item => setTimeout(() => changeBackgroundSmooth(item.img), item.time));

    // ----------- เนื้อหาคำพูด -----------
    const lines = [
      'ฝน: พี่ ปล่อยฝนเถอะ! ฝนไม่มีอะไรจะให้แล้ว พี่อยากได้อะไรก็เอาไปเลย! แต่อย่าทำอะไรฝนเลยนะ...',
      'ฉันยกมือขึ้นพนมไหว้ ร้องขอชีวิตทั้งน้ำตา แต่ดูเหมือนเขาไม่รับฟังอะไรเลย ดวงตาของเขาเต็มไปด้วยความคลุ้มคลั่งราวกับขาดสติ ฉันพยายามดิ้นสุดแรง ทุบตีเพื่อผลักเขาออก แต่แรงของฉันไม่อาจต้านเขาได้',
      'แต่แล้วเหมือนโชคชะตาจะเข้าข้างฉัน แสงจากรถยนต์คันหนึ่งสาดเข้ามาในความมืด ฉันเห็นโอกาสจึงรีบเปล่งเสียงร้องขอความช่วยเหลือ',
      'ฝน: "ช่วยด้วยค่ะ! ช่วยด้วย! มันจะข่มขืนหนู!"',
      'ไทม์: "เงียบ!"',
      'บิ๊ก: "เฮ้ย! ทำไรวะ!"',
      'ฝน: บิ๊ก!!?',
      'ไทม์: "ผัวเมียทะเลาะกันเอง อย่าเสือก!"',
      'บิ๊ก: "ผัวเมียไรวะ! นั่นแฟนกู!"',
      'ฝน: "พี่ปล่อยฝนเถอะนะ ฝนขอร้อง"',
      'บิ๊ก: "ปล่อยดิวะ!"',
      'ไทม์: "ก็บอกว่าเมียกูไง!"',
      'บิ๊ก: "ไม่ปล่อยใช่มั้ย? เดี๋ยวมึงเจอกู"',
      'บิ๊กเปิดประตูรถและเหมือนกำลังหาอะไรบางอย่าง',
      'บิ๊ก: "ถ้ามึงไม่ปล่อยกูยิง!"',
      'ไทม์: "แม่ง!"',
      'เมื่อเขาเห็นว่าบิ๊กมีปืน เขาก็รีบปล่อยฉันและวิ่งหนีไปทันที',
      'ไทม์: "ระวังตัวไว้เถอะฝน...คราวหน้ากูเอามึงตายแน่!"',
      'หลังพูดจบ เขาก็รีบหนีไปทันที ฉันยังคงตัวสั่น น้ำตาไหลด้วยความหวาดกลัว บิ๊กพยายามจะตามเขาไปแต่ฉันรั้งไว้ ขอให้พาไปส่งที่โรงพักก่อน เพราะไม่กล้าอยู่ตรงนี้ตามลำพัง',
      'เมื่อเรื่องถึงโรงพัก คนรอบตัวฉันต่างตกใจมากเพื่อนทุกคนก็รีบตามมาสมทบในเวลาไม่นาน โชคดีที่บิ๊กรู้สึกเป็นห่วงฉันเขาจึงขับรถกลับมา',
      'ฉันให้การอย่างละเอียดเกี่ยวกับรูปพรรณของคนร้าย ตำรวจจึงค้นข้อมูลย้อนหลัง — และนั่นทำให้ฉันช็อกอีกครั้ง…\nพี่ไทม์คือโรคจิตที่เคยก่อเหตุในลักษณะนี้มาแล้วหลายครั้ง\nและสิ่งที่น่าตกใจยิ่งกว่านั้นคือ เขาคือลูกชายของเจ้าของร้านที่ฉันทำงานอยู่!',
      'ตำรวจโทรแจ้งคุณป้าเจ้าของร้านเพื่อเล่าเรื่องที่เกิดขึ้น คำพูดของเธอทำให้ฉันแทบลุกไม่ขึ้น...',
      '“ก็รู้ว่าลูกชายเป็นแบบนี้มานานแล้ว แต่ไม่รู้จะทำยังไง เลยไม่อยากยุ่ง”\n“ช่วยปิดเรื่องนี้ไว้ได้มั้ย เด็กคนนั้นก็ไม่ตายนี่จะเอาเงินเท่าไหร่ล่ะ?”',
      'แม้แต่ตำรวจบางคนก็มีท่าทีลังเลราวกับจะเข้าข้างเขา ฉันนั่งตัวสั่นไม่กล้าพูดอะไร...แต่โชคดีที่ยังมีบิ๊กและเพื่อน ๆ อยู่ข้างฉัน พวกเขาไม่ยอมให้เรื่องจบแค่นั้น และพยายามจะเอาผิดให้ถึงที่สุด',
      'ในเวลาต่อมา เรื่องของฉันกลายเป็นข่าว และถูกแชร์ในโลกออนไลน์ ฉันไม่เคยคิดเลย...ว่าตัวเองจะกลายเป็นเหยื่อของโรคจิตแบบนี้',
      'มันสอนให้ฉันรู้ว่า...\nเหตุการณ์เลวร้ายแบบนี้ ไม่ใช่เรื่องไกลตัวเลย\nมันสามารถเกิดขึ้นกับใครก็ได้ — แม้แต่คุณที่กำลังฟังเรื่องของฉันในตอนนี้...'
    ];

    let index = 0;

    function nextLine() {
      if (index >= lines.length) {
        window.location.href = "Night5-last-night.html";
        return;
      }

      const text = lines[index];
      let html = '';

      if (text.includes(':')) {
        const speaker = text.split(':')[0].trim();
        const content = text.split(':').slice(1).join(':').trim();
        let className = '';
        if (speaker === 'ฝน') className = 'fon';
        else if (speaker === 'ไทม์') className = 'time';
        else if (speaker === 'บิ๊ก') className = 'teen';
        else className = 'speaker';
        html = `<div class="caption-line"><span class="speaker ${className}">${speaker}:</span> ${content}</div>`;
      } else {
        html = `<div class="caption-line narration">${text.replace(/\n/g, "<br>")}</div>`;
      }

      captionEl.style.opacity = 0;
      setTimeout(() => {
        captionEl.innerHTML = html;
        captionEl.style.opacity = 1;
      }, 150);

      index++;
    }

    // เริ่มแรกเมื่อโหลดหน้า
    window.onload = nextLine;

    // กด anywhere บน body เพื่อเปลี่ยนข้อความ
    document.body.addEventListener('click', nextLine);
  </script>
</body>
</html>
